groups:
- name: ippan-ai-service
  rules:
  - alert: ServiceDown
    expr: up{job="ippan-ai-service"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "IPPAN AI Service is down"
      description: "The IPPAN AI Service has been down for more than 1 minute."

  - alert: HighErrorRate
    expr: rate(ippan_ai_errors_total[5m]) > 0.1
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "High error rate detected"
      description: "The error rate is {{ $value }} errors per second."

  - alert: HighResponseTime
    expr: histogram_quantile(0.95, rate(ippan_ai_request_duration_seconds_bucket[5m])) > 5
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High response time detected"
      description: "The 95th percentile response time is {{ $value }} seconds."

  - alert: HighMemoryUsage
    expr: ippan_ai_memory_usage_bytes > 1.5e9
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High memory usage detected"
      description: "Memory usage is {{ $value }} bytes."

  - alert: HighCPUUsage
    expr: ippan_ai_cpu_usage_percent > 80
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High CPU usage detected"
      description: "CPU usage is {{ $value }}%."

  - alert: LowRequestRate
    expr: rate(ippan_ai_requests_total[5m]) < 0.1
    for: 10m
    labels:
      severity: info
    annotations:
      summary: "Low request rate detected"
      description: "Request rate is {{ $value }} requests per second."

  - alert: ServiceUnhealthy
    expr: up{job="ippan-ai-service"} == 1 and rate(ippan_ai_errors_total[5m]) > 0.05
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "Service is unhealthy"
      description: "The service is running but has a high error rate."